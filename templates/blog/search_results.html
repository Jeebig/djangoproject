{% extends 'blog/base.html' %}

{% block main %}
<div class="page-header">
    <h1>{{ title }}</h1>
    {% if query %}
    <p class="text-muted">
        Найдено постов: {{ posts|length }}
        {% if page_obj.paginator.num_pages > 1 %}
        (страница {{ page_obj.number }} из {{ page_obj.paginator.num_pages }})
        {% endif %}
    </p>
    {% endif %}
</div>

{% if query %}
{% if posts %}
{% for post in posts %}
<!-- Search Result Post -->
<h2>
    <a href="{% url 'blog:post-detail-slug' post.slug %}">{{ post.title }}</a>
</h2>
{% if post.tags.all %}
<p class="tags">
    <strong>Теги:</strong>
    {% for tag in post.tags.all %}
    <a href="{% url 'blog:tag-posts' tag.name %}" class="label label-primary">{{ tag.name }}</a>
    {% endfor %}
</p>
{% endif %}
<p class="lead">
    by <a href="#">{{ post.author.username }}</a> • Категория: <a href="{% url 'blog:category-posts' post.category.slug %}">{{ post.category.name }}</a>
</p>
<p><span class="glyphicon glyphicon-time"></span> Posted on {{ post.created_at|date:"F d, Y H:i" }}</p>
<hr>
{% if post.image %}
<img class="img-responsive" src="{{ post.image }}" alt="{{ post.title }}">
{% else %}
<img class="img-responsive" src="https://via.placeholder.com/900x300" alt="placeholder">
{% endif %}
<hr>
<p>{{ post.content|truncatewords:30 }}</p>
<a class="btn btn-primary" href="{% url 'blog:post-detail-slug' post.slug %}">Read More <span
        class="glyphicon glyphicon-chevron-right"></span></a>
<hr>
{% endfor %}

<!-- Пагинация результатов поиска -->
{% if page_obj.paginator.num_pages > 1 %}
<hr>
<ul class="pager">
    {% if page_obj.has_next %}
    <li class="previous">
        <a href="?q={{ query }}&page={{ page_obj.next_page_number }}">&larr; Older</a>
    </li>
    {% endif %}
    {% if page_obj.has_previous %}
    <li class="next">
        <a href="?q={{ query }}&page={{ page_obj.previous_page_number }}">Newer &rarr;</a>
    </li>
    {% endif %}
</ul>
{% endif %}
{% else %}
<div class="alert alert-info">
    <h4>Ничего не найдено</h4>
    <p>По вашему запросу "{{ query }}" ничего не найдено. Попробуйте изменить поисковый запрос.</p>
</div>
{% endif %}
{% else %}
<div class="alert alert-warning">
    <h4>Введите поисковый запрос</h4>
    <p>Используйте форму поиска в боковой панели для поиска постов.</p>
</div>
{% endif %}

{% endblock %}