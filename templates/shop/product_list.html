{% extends 'blog/base.html' %}
{% block main %}
<h2>Товары</h2>
<div class="row">
  {% for p in products %}
  <div class="col-md-4 mb-3">
    <div class="card h-100 card-product">
      {% if p.thumbnail %}
        <img src="{{ p.thumbnail.url }}" class="card-img-top" alt="{{ p.name }}" height="180">
      {% elif p.image %}
        <img src="{{ p.image.url }}" class="card-img-top" alt="{{ p.name }}" height="180">
      {% endif %}
      <div class="card-body d-flex flex-column">
        <h5 class="card-title">{{ p.name }}</h5>
        <p class="card-text">{{ p.description|truncatechars:120 }}</p>
        <div class="mt-auto d-flex justify-content-between align-items-center">
          <span class="fw-bold">{{ p.price }} ₴</span>
          <div>
            <form class="d-inline" method="post" action="{% url 'shop:cart-add' p.id %}">{% csrf_token %}
              <input type="hidden" name="next" value="{{ request.get_full_path }}">
              <button class="btn btn-sm btn-primary" type="submit" aria-label="В корзину"><i class="bi bi-cart-plus"></i></button>
            </form>
            <a class="btn btn-sm btn-outline-secondary" href="{% url 'shop:product-detail' slug=p.slug %}">Подробнее</a>
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endfor %}
  {% if not products %}<div class="text-muted">Пока нет товаров.</div>{% endif %}
</div>
{% endblock %}
{% block sidebar %}{% endblock %}
